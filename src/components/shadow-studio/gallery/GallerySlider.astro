---
import "keen-slider/keen-slider.min.css";

interface Props {
  items: Array<{
    id: number;
    category: string;
    image: string;
    title: string;
    artist: string;
  }>;
}

const { items } = Astro.props;
---

<div class="relative group px-6 md:px-16 pb-16">
  <div
    id="keen-slider"
    class="keen-slider overflow-visible"
    style="opacity: 0; transition: opacity 0.5s ease;"
  >
    {
      items.map((item) => (
        <div
          class="keen-slider__slide relative aspect-[3/4] md:aspect-[4/5] overflow-hidden rounded-sm cursor-pointer gallery-slide"
          data-category={item.category}
          data-image={item.image}
          data-title={item.title}
          data-artist={item.artist}
          onclick={`openLightbox('${item.image}', '${item.title}', '${item.artist}')`}
        >
          <img
            src={item.image}
            alt={item.title}
            loading="lazy"
            class="w-full h-full object-cover transition-transform duration-700 hover:scale-110 filter grayscale-[20%] hover:grayscale-0"
          />

          <div class="absolute inset-0 bg-gradient-to-t from-primarybg/90 via-transparent to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
            <p class="text-aux-secondary text-[10px] font-bold uppercase tracking-widest mb-2">
              {item.category}
            </p>
            <h3 class="text-xl font-bold text-white uppercase tracking-tight">
              {item.title}
            </h3>
            <span class="text-gray-400 text-xs mt-1">por {item.artist}</span>
          </div>
        </div>
      ))
    }
  </div>

  <div
    class="absolute bottom-6 left-6 right-6 md:left-0 md:right-0 h-[2px] bg-white/10 rounded-full overflow-hidden mt-4"
  >
    <div
      id="progress-bar"
      class="h-full bg-aux-secondary w-0 transition-all duration-100 ease-out origin-left"
    >
    </div>
  </div>

  <div
    id="swipe-hint"
    class="absolute bottom-0 left-0 right-0 text-center pt-4 animate-on-scroll opacity-0 translate-y-2 transition-all duration-1000 delay-700"
  >
    <div class="inline-flex items-center justify-center gap-2">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-4 h-4 text-white/50 opacity-0 animate-shake-x-reverse transition-opacity"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path>
      </svg>

      <span
        class="text-[10px] font-medium uppercase tracking-wider text-white/50"
      >
        Desliza para explorar
      </span>

      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="2"
        stroke="currentColor"
        class="w-4 h-4 text-aux-secondary animate-shake-x transition-opacity"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"></path>
      </svg>
    </div>
  </div>

  <button
    id="arrow-left"
    class="hidden md:flex absolute top-1/2 -left-12 md:left-0 -translate-y-1/2 w-10 h-10 items-center justify-center border border-white/10 rounded-full text-white hover:bg-white/10 hover:border-aux-secondary transition-all duration-300 z-20"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="w-5 h-5"
      ><path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M15.75 19.5L8.25 12l7.5-7.5"></path></svg
    >
  </button>

  <button
    id="arrow-right"
    class="hidden md:flex absolute top-1/2 -right-12 md:right-0 -translate-y-1/2 w-10 h-10 items-center justify-center border border-white/10 rounded-full text-white hover:bg-white/10 hover:border-aux-secondary transition-all duration-300 z-20"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="w-5 h-5"
      ><path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M8.25 4.5l7.5 7.5-7.5 7.5"></path></svg
    >
  </button>
</div>

<script>
  import { initSlider } from "./gallerySlider.js";

  initSlider();
</script>

<style>
  .keen-slider {
    cursor: grab;
  }
  .keen-slider:active {
    cursor: grabbing;
  }
  @keyframes shakeX {
    0%,
    100% {
      transform: translateX(0);
    }
    25% {
      transform: translateX(3px);
    }
    50% {
      transform: translateX(-3px);
    }
    75% {
      transform: translateX(3px);
    }
  }

  .animate-shake-x {
    animation: shakeX 1.5s ease-in-out infinite;
  }

  .animate-shake-x-reverse {
    animation: shakeX 1.5s ease-in-out infinite reverse;
  }
</style>
